import os
from google.cloud import bigquery

def execute_uploader(_directory):
    directory = _directory
    for file_name in os.listdir(directory):
        print(directory + "/" + file_name)
        if file_name.endswith("goals_funnels_report_output.csv"):
            upload_goals_funnels_stats_table(directory, file_name)
        elif file_name.endswith("ads_performance_report_output.csv"):
            upload_ads_performance_table(directory, file_name)
        elif file_name.endswith("keyword_performance_report_output.csv"):
            upload_keyword_performance_table(directory, file_name)
        elif file_name.endswith("search_query_performance_report_output.csv"):
            upload_search_query_performance_table(directory, file_name)
        elif file_name.endswith("user_location_performance_report_output.csv"):
            upload_user_location_performance_table(directory, file_name)
        elif file_name.endswith("ads_dictionary_report_output.csv"):
            upload_ads_dictionary_table(directory, file_name)


ms_ads_tables_schema = {'microsoft_ads_keyword_performance_table':
bq_table_schema = [
    bigquery.SchemaField('_insert_time', 'TIMESTAMP'),
    bigquery.SchemaField('AccountName', 'STRING'),
    bigquery.SchemaField('AccountNumber', 'STRING'),
    bigquery.SchemaField('AccountId', 'INT64'),
    bigquery.SchemaField('TimePeriod', 'DATE'),
    bigquery.SchemaField('CampaignName', 'STRING'),
    bigquery.SchemaField('CampaignId', 'INT64'),
    bigquery.SchemaField('AdGroupName', 'STRING'),
    bigquery.SchemaField('AdGroupId', 'INT64'),
    bigquery.SchemaField('Keyword', 'STRING'),
    bigquery.SchemaField('KeywordId', 'INT64'),
    bigquery.SchemaField('AdId', 'INT64'),
    bigquery.SchemaField('AdType', 'STRING'),
    bigquery.SchemaField('DestinationUrl', 'STRING'),
    bigquery.SchemaField('CurrentMaxCpc', 'FLOAT64'),
    bigquery.SchemaField('CurrencyCode', 'STRING'),
    bigquery.SchemaField('DeliveredMatchType', 'STRING'),
    bigquery.SchemaField('AdDistribution', 'STRING'),
    bigquery.SchemaField('Impressions', 'INT64'),
    bigquery.SchemaField('Clicks', 'INT64'),
    bigquery.SchemaField('AverageCpc', 'FLOAT64'),
    bigquery.SchemaField('Spend', 'FLOAT64'),
    bigquery.SchemaField('AveragePosition', 'FLOAT64'),
    bigquery.SchemaField('Conversions', 'FLOAT64'),
    bigquery.SchemaField('CostPerConversion', 'FLOAT64'),
    bigquery.SchemaField('BidMatchType', 'STRING'),
    bigquery.SchemaField('DeviceType', 'STRING'),
    bigquery.SchemaField('QualityScore', 'STRING'),
    bigquery.SchemaField('ExpectedCtr', 'STRING'),
    bigquery.SchemaField('AdRelevance', 'STRING'),
    bigquery.SchemaField('LandingPageExperience', 'STRING'),
    bigquery.SchemaField('Language', 'STRING'),
    bigquery.SchemaField('HistoricalQualityScore', 'STRING'),
    bigquery.SchemaField('HistoricalExpectedCtr', 'STRING'),
    bigquery.SchemaField('HistoricalAdRelevance', 'STRING'),
    bigquery.SchemaField('HistoricalLandingPageExperience', 'STRING'),
    bigquery.SchemaField('QualityImpact', 'INT64'),
    bigquery.SchemaField('CampaignStatus', 'STRING'),
    bigquery.SchemaField('AccountStatus', 'STRING'),
    bigquery.SchemaField('AdGroupStatus', 'STRING'),
    bigquery.SchemaField('KeywordStatus', 'STRING'),
    bigquery.SchemaField('Network', 'STRING'),
    bigquery.SchemaField('TopVsOther', 'STRING'),
    bigquery.SchemaField('DeviceOS', 'STRING'),
    bigquery.SchemaField('Assists', 'FLOAT64'),
    bigquery.SchemaField('Revenue', 'FLOAT64'),
    bigquery.SchemaField('ReturnOnAdSpend', 'FLOAT64'),
    bigquery.SchemaField('CostPerAssist', 'FLOAT64'),
    bigquery.SchemaField('RevenuePerConversion', 'FLOAT64'),
    bigquery.SchemaField('RevenuePerAssist', 'FLOAT64'),
    bigquery.SchemaField('TrackingTemplate', 'STRING'),
    bigquery.SchemaField('CustomParameters', 'STRING'),
    bigquery.SchemaField('FinalUrl', 'STRING'),
    bigquery.SchemaField('FinalMobileUrl', 'STRING'),
    bigquery.SchemaField('FinalAppUrl', 'STRING'),
    bigquery.SchemaField('BidStrategyType', 'STRING'),
    bigquery.SchemaField('KeywordLabels', 'STRING'),
    bigquery.SchemaField('Mainline1Bid', 'FLOAT64'),
    bigquery.SchemaField('MainlineBid', 'FLOAT64'),
    bigquery.SchemaField('FirstPageBid', 'FLOAT64'),
    bigquery.SchemaField('FinalUrlSuffix', 'STRING'),
    bigquery.SchemaField('BaseCampaignId', 'INT64'),
    bigquery.SchemaField('AllConversions', 'FLOAT64'),
    bigquery.SchemaField('AllRevenue', 'FLOAT64'),
    bigquery.SchemaField('AllCostPerConversion', 'FLOAT64'),
    bigquery.SchemaField('AllReturnOnAdSpend', 'FLOAT64'),
    bigquery.SchemaField('AllRevenuePerConversion', 'FLOAT64')
  ],

  'microsoft_ads_search_query_performance_table':
  bq_table_schema = [
    bigquery.SchemaField('_insert_time', 'TIMESTAMP'),
    bigquery.SchemaField('AccountName', 'STRING'),
    bigquery.SchemaField('AccountNumber', 'STRING'),
    bigquery.SchemaField('AccountId', 'INT64'),
    bigquery.SchemaField('TimePeriod', 'DATE'),
    bigquery.SchemaField('CampaignName', 'STRING'),
    bigquery.SchemaField('CampaignId', 'INT64'),
    bigquery.SchemaField('AdGroupName', 'STRING'),
    bigquery.SchemaField('AdGroupId', 'INT64'),
    bigquery.SchemaField('AdId', 'INT64'),
    bigquery.SchemaField('AdType', 'STRING'),
    bigquery.SchemaField('DestinationUrl', 'STRING'),
    bigquery.SchemaField('BidMatchType', 'STRING'),
    bigquery.SchemaField('DeliveredMatchType', 'STRING'),
    bigquery.SchemaField('CampaignStatus', 'STRING'),
    bigquery.SchemaField('AdStatus', 'STRING'),
    bigquery.SchemaField('Impressions', 'INT64'),
    bigquery.SchemaField('Clicks', 'INT64'),
    bigquery.SchemaField('AverageCpc', 'FLOAT64'),
    bigquery.SchemaField('Spend', 'FLOAT64'),
    bigquery.SchemaField('AveragePosition', 'FLOAT64'),
    bigquery.SchemaField('SearchQuery', 'STRING'),
    bigquery.SchemaField('Keyword', 'STRING'),
    bigquery.SchemaField('AdGroupCriterionId', 'INT64'),
    bigquery.SchemaField('Conversions', 'FLOAT64'),
    bigquery.SchemaField('CostPerConversion', 'FLOAT64'),
    bigquery.SchemaField('Language', 'STRING'),
    bigquery.SchemaField('KeywordId', 'INT64'),
    bigquery.SchemaField('Network', 'STRING'),
    bigquery.SchemaField('TopVsOther', 'STRING'),
    bigquery.SchemaField('DeviceType', 'STRING'),
    bigquery.SchemaField('DeviceOS', 'STRING'),
    bigquery.SchemaField('Assists', 'FLOAT64'),
    bigquery.SchemaField('Revenue', 'FLOAT64'),
    bigquery.SchemaField('ReturnOnAdSpend', 'FLOAT64'),
    bigquery.SchemaField('CostPerAssist', 'FLOAT64'),
    bigquery.SchemaField('RevenuePerConversion', 'FLOAT64'),
    bigquery.SchemaField('RevenuePerAssist', 'FLOAT64'),
    bigquery.SchemaField('AccountStatus', 'STRING'),
    bigquery.SchemaField('AdGroupStatus', 'STRING'),
    bigquery.SchemaField('KeywordStatus', 'STRING'),
    bigquery.SchemaField('CampaignType', 'STRING'),
    bigquery.SchemaField('CustomerId', 'INT64'),
    bigquery.SchemaField('CustomerName', 'STRING'),
    bigquery.SchemaField('AllConversions', 'FLOAT64'),
    bigquery.SchemaField('AllRevenue', 'FLOAT64'),
    bigquery.SchemaField('AllCostPerConversion', 'FLOAT64'),
    bigquery.SchemaField('AllReturnOnAdSpend', 'FLOAT64'),
    bigquery.SchemaField('AllRevenuePerConversion', 'FLOAT64')
  ],

  'microsoft_ads_user_location_performance_table':
  bq_table_schema = [
    bigquery.SchemaField('_insert_time', 'TIMESTAMP'),
    bigquery.SchemaField('AccountName', 'STRING'),
    bigquery.SchemaField('AccountNumber', 'STRING'),
    bigquery.SchemaField('AccountId', 'INT64'),
    bigquery.SchemaField('TimePeriod', 'DATE'),
    bigquery.SchemaField('CampaignName', 'STRING'),
    bigquery.SchemaField('CampaignId', 'INT64'),
    bigquery.SchemaField('AdGroupName', 'STRING'),
    bigquery.SchemaField('AdGroupId', 'INT64'),
    bigquery.SchemaField('Country', 'STRING'),
    bigquery.SchemaField('State', 'STRING'),
    bigquery.SchemaField('MetroArea', 'STRING'),
    bigquery.SchemaField('AdDistribution', 'STRING'),
    bigquery.SchemaField('Impressions', 'INT64'),
    bigquery.SchemaField('Clicks', 'INT64'),
    bigquery.SchemaField('AverageCpc', 'FLOAT64'),
    bigquery.SchemaField('Spend', 'FLOAT64'),
    bigquery.SchemaField('AveragePosition', 'FLOAT64'),
    bigquery.SchemaField('ProximityTargetLocation', 'STRING'),
    bigquery.SchemaField('Radius', 'STRING'),
    bigquery.SchemaField('Language', 'STRING'),
    bigquery.SchemaField('City', 'STRING'),
    bigquery.SchemaField('QueryIntentCountry', 'STRING'),
    bigquery.SchemaField('QueryIntentState', 'STRING'),
    bigquery.SchemaField('QueryIntentCity', 'STRING'),
    bigquery.SchemaField('QueryIntentDMA', 'STRING'),
    bigquery.SchemaField('BidMatchType', 'STRING'),
    bigquery.SchemaField('DeliveredMatchType', 'STRING'),
    bigquery.SchemaField('Network', 'STRING'),
    bigquery.SchemaField('TopVsOther', 'STRING'),
    bigquery.SchemaField('DeviceType', 'STRING'),
    bigquery.SchemaField('DeviceOS', 'STRING'),
    bigquery.SchemaField('Assists', 'FLOAT64'),
    bigquery.SchemaField('Conversions', 'FLOAT64'),
    bigquery.SchemaField('Revenue', 'FLOAT64'),
    bigquery.SchemaField('ReturnOnAdSpend', 'FLOAT64'),
    bigquery.SchemaField('CostPerConversion', 'FLOAT64'),
    bigquery.SchemaField('CostPerAssist', 'FLOAT64'),
    bigquery.SchemaField('RevenuePerConversion', 'FLOAT64'),
    bigquery.SchemaField('RevenuePerAssist', 'FLOAT64'),
    bigquery.SchemaField('County', 'STRING'),
    bigquery.SchemaField('PostalCode', 'STRING'),
    bigquery.SchemaField('QueryIntentCounty', 'STRING'),
    bigquery.SchemaField('QueryIntentPostalCode', 'STRING'),
    bigquery.SchemaField('LocationId', 'INT64'),
    bigquery.SchemaField('QueryIntentLocationId', 'INT64'),
    bigquery.SchemaField('AllConversions', 'FLOAT64'),
    bigquery.SchemaField('AllRevenue', 'FLOAT64'),
    bigquery.SchemaField('AllCostPerConversion', 'FLOAT64'),
    bigquery.SchemaField('AllReturnOnAdSpend', 'FLOAT64'),
    bigquery.SchemaField('AllRevenuePerConversion', 'FLOAT64')
  ],

  'microsoft_ads_user_location_performance_table':
  bq_table_schema = [
    bigquery.SchemaField('_insert_time', 'TIMESTAMP'),
    bigquery.SchemaField('AccountName', 'STRING'),
    bigquery.SchemaField('AccountNumber', 'STRING'),
    bigquery.SchemaField('AccountId', 'INT64'),
    bigquery.SchemaField('TimePeriod', 'DATE'),
    bigquery.SchemaField('CampaignName', 'STRING'),
    bigquery.SchemaField('CampaignId', 'INT64'),
    bigquery.SchemaField('AdGroupName', 'STRING'),
    bigquery.SchemaField('AdGroupId', 'INT64'),
    bigquery.SchemaField('Country', 'STRING'),
    bigquery.SchemaField('State', 'STRING'),
    bigquery.SchemaField('MetroArea', 'STRING'),
    bigquery.SchemaField('AdDistribution', 'STRING'),
    bigquery.SchemaField('Impressions', 'INT64'),
    bigquery.SchemaField('Clicks', 'INT64'),
    bigquery.SchemaField('AverageCpc', 'FLOAT64'),
    bigquery.SchemaField('Spend', 'FLOAT64'),
    bigquery.SchemaField('AveragePosition', 'FLOAT64'),
    bigquery.SchemaField('ProximityTargetLocation', 'STRING'),
    bigquery.SchemaField('Radius', 'STRING'),
    bigquery.SchemaField('Language', 'STRING'),
    bigquery.SchemaField('City', 'STRING'),
    bigquery.SchemaField('QueryIntentCountry', 'STRING'),
    bigquery.SchemaField('QueryIntentState', 'STRING'),
    bigquery.SchemaField('QueryIntentCity', 'STRING'),
    bigquery.SchemaField('QueryIntentDMA', 'STRING'),
    bigquery.SchemaField('BidMatchType', 'STRING'),
    bigquery.SchemaField('DeliveredMatchType', 'STRING'),
    bigquery.SchemaField('Network', 'STRING'),
    bigquery.SchemaField('TopVsOther', 'STRING'),
    bigquery.SchemaField('DeviceType', 'STRING'),
    bigquery.SchemaField('DeviceOS', 'STRING'),
    bigquery.SchemaField('Assists', 'FLOAT64'),
    bigquery.SchemaField('Conversions', 'FLOAT64'),
    bigquery.SchemaField('Revenue', 'FLOAT64'),
    bigquery.SchemaField('ReturnOnAdSpend', 'FLOAT64'),
    bigquery.SchemaField('CostPerConversion', 'FLOAT64'),
    bigquery.SchemaField('CostPerAssist', 'FLOAT64'),
    bigquery.SchemaField('RevenuePerConversion', 'FLOAT64'),
    bigquery.SchemaField('RevenuePerAssist', 'FLOAT64'),
    bigquery.SchemaField('County', 'STRING'),
    bigquery.SchemaField('PostalCode', 'STRING'),
    bigquery.SchemaField('QueryIntentCounty', 'STRING'),
    bigquery.SchemaField('QueryIntentPostalCode', 'STRING'),
    bigquery.SchemaField('LocationId', 'INT64'),
    bigquery.SchemaField('QueryIntentLocationId', 'INT64'),
    bigquery.SchemaField('AllConversions', 'FLOAT64'),
    bigquery.SchemaField('AllRevenue', 'FLOAT64'),
    bigquery.SchemaField('AllCostPerConversion', 'FLOAT64'),
    bigquery.SchemaField('AllReturnOnAdSpend', 'FLOAT64'),
    bigquery.SchemaField('AllRevenuePerConversion', 'FLOAT64')
  ],

  'microsoft_ads_ads_dictionary_table':
  bq_ads_dictionary_table_table_schema = [
    bigquery.SchemaField('_insert_time', 'TIMESTAMP'),
    bigquery.SchemaField('AccountName', 'STRING'),
    bigquery.SchemaField('AccountNumber', 'STRING'),
    bigquery.SchemaField('AccountId', 'INT64'),
    bigquery.SchemaField('CampaignName', 'STRING'),
    bigquery.SchemaField('CampaignId', 'INT64'),
    bigquery.SchemaField('AdGroupName', 'STRING'),
    bigquery.SchemaField('AdId', 'INT64'),
    bigquery.SchemaField('AdGroupId', 'INT64'),
    bigquery.SchemaField('AdTitle', 'STRING'),
    bigquery.SchemaField('AdDescription', 'STRING'),
    bigquery.SchemaField('AdDescription2', 'STRING'),
    bigquery.SchemaField('AdType', 'STRING'),
    bigquery.SchemaField('AdDistribution', 'STRING'),
    bigquery.SchemaField('Impressions', 'INT64'),
    bigquery.SchemaField('DestinationUrl', 'STRING'),
    bigquery.SchemaField('DisplayUrl', 'STRING'),
    bigquery.SchemaField('AdStatus', 'STRING'),
    bigquery.SchemaField('TrackingTemplate', 'STRING'),
    bigquery.SchemaField('CustomParameters', 'STRING'),
    bigquery.SchemaField('FinalUrl', 'STRING'),
    bigquery.SchemaField('FinalMobileUrl', 'STRING'),
    bigquery.SchemaField('FinalAppUrl', 'STRING'),
    bigquery.SchemaField('AccountStatus', 'STRING'),
    bigquery.SchemaField('CampaignStatus', 'STRING'),
    bigquery.SchemaField('AdGroupStatus', 'STRING'),
    bigquery.SchemaField('TitlePart1', 'STRING'),
    bigquery.SchemaField('TitlePart2', 'STRING'),
    bigquery.SchemaField('TitlePart3', 'STRING'),
    bigquery.SchemaField('Headline', 'STRING'),
    bigquery.SchemaField('LongHeadline', 'STRING'),
    bigquery.SchemaField('BusinessName', 'STRING'),
    bigquery.SchemaField('Path1', 'STRING'),
    bigquery.SchemaField('Path2', 'STRING'),
    bigquery.SchemaField('CustomerId', 'INT64'),
    bigquery.SchemaField('CustomerName', 'STRING'),
    bigquery.SchemaField('CampaignType', 'STRING'),
    bigquery.SchemaField('BaseCampaignId', 'INT64'),
    bigquery.SchemaField('FinalUrlSuffix', 'STRING')
  ]
}
